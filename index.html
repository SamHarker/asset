<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Gestione Postazioni</title>
  <style>
    body { font-family: Arial; background:#2b2b2b; color:white; text-align:center; }
    table { border-collapse: collapse; width:90%; margin:20px auto; }
    th, td { border:1px solid red; padding:8px; text-align:center; }
    thead tr { background:black; }
    tbody tr:nth-child(odd){ background:#4d4d4d; }
    tbody tr:nth-child(even){ background:#808080; }
    .btn { margin:10px; padding:10px 20px; background:red; color:white; border:none; border-radius:6px; cursor:pointer; }
    .btn:hover { background:darkred; }
    .remove-btn { background:#cc0000; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer; }
    .remove-btn:hover { background:#990000; }
  </style>
</head>
<body>

  <h1>üìã Gestione Postazioni di Lavoro</h1>

  <button onclick="exportTableToJSON()">üíæ Esporta in JSON</button>
  <button class="btn" onclick="addRow()">‚ûï Aggiungi riga</button>

  <table id="postazioni">
    <thead>
      <tr>
        <th>Stanza</th>
        <th>Scrivania</th>
        <th>Workstation</th>
        <th>Monitor</th>
        <th>Docking</th>
        <th>Note</th>
        <th>Azioni</th>
      </tr>
    </thead>
    <tbody>
      <!-- Popolato automaticamente dal JSON -->
    </tbody>
  </table>

  <script>

function exportTableToJSON() {
  const table = document.getElementById("postazioni");
  const headers = [];
  const data = [];

  // Leggi intestazioni
  for (let th of table.querySelectorAll("thead th")) {
    if (th.innerText !== "Azioni") headers.push(th.innerText);
  }

  // Leggi righe
  for (let row of table.querySelectorAll("tbody tr")) {
    const rowData = {};
    const cells = row.querySelectorAll("td");
    cells.forEach((cell, i) => {
      if (i < headers.length) rowData[headers[i]] = cell.innerText;
    });
    data.push(rowData);
  }

  // Converti in JSON
  const json = JSON.stringify(data, null, 2);

  // Scarica come file
  const blob = new Blob([json], { type: "application/json" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "postazioni.json";
  a.click();
}


    // Popola la tabella con i dati caricati da JSON
    function populateTable(data) {
      const tbody = document.querySelector("#postazioni tbody");
      tbody.innerHTML = "";
      data.forEach(item => {
        const row = tbody.insertRow();
        row.innerHTML = `
          <td contenteditable="true">${item.stanza}</td>
          <td contenteditable="true">${item.scrivania}</td>
          <td contenteditable="true">${item.workstation}</td>
          <td contenteditable="true">${item.monitor}</td>
          <td contenteditable="true">${item.docking}</td>
          <td contenteditable="true">${item.note}</td>
          <td><button class="remove-btn" onclick="removeRow(this)">‚ùå Rimuovi</button></td>
        `;
      });
    }
    
    // Carica automaticamente i dati dal file JSON
    async function loadJSON() {
      try {
        const response = await fetch("postazioni.json"); // deve trovarsi nella stessa cartella
        if (!response.ok) throw new Error("File non trovato");
        const data = await response.json();
        populateTable(data);
      } catch (error) {
        alert("‚ö†Ô∏è Errore nel caricamento del JSON: " + error.message);
        console.error(error);
    }
    }

    // Funzione per aggiungere una nuova riga vuota
    function addRow() {
      const tbody = document.querySelector("#postazioni tbody");
      const row = tbody.insertRow();
      row.innerHTML = `
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td><button class="remove-btn" onclick="removeRow(this)">‚ùå Rimuovi</button></td>
      `;
    }

    // Funzione per rimuovere una riga
    function removeRow(button) {
      button.closest("tr").remove();
    }

    // Carica i dati automaticamente all‚Äôapertura
    window.onload = loadJSON;
    
<!-- Richiamo del tuo script -->
  script.js
    function highlightDuplicates() {
  const table = document.getElementById("postazioni");
  const columnsToCheck = ["Workstation", "Monitor", "Docking"];
  const headers = Array.from(table.querySelectorAll("thead th")).map(th => th.innerText);

  // Reset colori
  table.querySelectorAll("tbody td").forEach(cell => cell.style.backgroundColor = "");

  columnsToCheck.forEach(colName => {
    const colIndex = headers.indexOf(colName);
    if (colIndex === -1) return;

    const valuesMap = {};
    const rows = table.querySelectorAll("tbody tr");

    rows.forEach(row => {
      const cell = row.querySelectorAll("td")[colIndex];
      let value = "";
      const input = cell.querySelector("input");
      value = input ? input.value.trim() : cell.innerText.trim();

      if (value) {
        if (valuesMap[value]) {
          cell.style.backgroundColor = "#ffcccc";
          valuesMap[value].style.backgroundColor = "#ffcccc";
        } else {
          valuesMap[value] = cell;
        }
      }
    });
  });
}

// Attiva controllo duplicati all'avvio
highlightDuplicates();
  </script>

</body>
</html>









