<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Gestione Postazioni</title>
  <style>
    body { font-family: Arial; background:#2b2b2b; color:white; text-align:center; }
    table { border-collapse: collapse; width:90%; margin:20px auto; }
    th, td { border:1px solid red; padding:8px; text-align:center; }
    thead tr { background:black; }
    tbody tr:nth-child(odd){ background:#4d4d4d; }
    tbody tr:nth-child(even){ background:#808080; }
    .btn { margin:10px; padding:10px 20px; background:red; color:white; border:none; border-radius:6px; cursor:pointer; }
    .btn:hover { background:darkred; }
    .remove-btn { background:#cc0000; color:white; border:none; padding:4px 8px; border-radius:4px; cursor:pointer; }
    .remove-btn:hover { background:#990000; }
  </style>
</head>
<body>

  <h1>üìã Gestione Postazioni di Lavoro</h1>

  <button class="btn" onclick="saveToGitHub()">üíæ Salva su GitHub</button>
  <button class="btn" onclick="addRow()">‚ûï Aggiungi riga</button>

  <table id="postazioni">
    <thead>
      <tr>
        <th>Stanza</th>
        <th>Scrivania</th>
        <th>Workstation</th>
        <th>Monitor</th>
        <th>Docking</th>
        <th>Note</th>
        <th>Azioni</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td contenteditable="true">1029B</td>
        <td contenteditable="true">1</td>
        <td contenteditable="true">CNK9221GVV</td>
        <td contenteditable="true">1H9521ZN8P</td>
        <td contenteditable="true">XB2002</td>
        <td contenteditable="true"></td>
        <td><button class="remove-btn" onclick="removeRow(this)">‚ùå Rimuovi</button></td>
      </tr>
      <tr>
        <td contenteditable="true">1024B</td>
        <td contenteditable="true">2</td>
        <td contenteditable="true">CNK9221GWR</td>
        <td contenteditable="true">1H9521ZNPK</td>
        <td contenteditable="true">XB2002</td>
        <td contenteditable="true">Manca etichetta desk</td>
        <td><button class="remove-btn" onclick="removeRow(this)">‚ùå Rimuovi</button></td>
      </tr>
    </tbody>
  </table>

  <script>
    // Funzione per raccogliere i dati e inviare a GitHub
    async function saveToGitHub() {
      const rows = Array.from(document.querySelector("#postazioni tbody").rows).map(row => ({
        stanza: row.cells[0].textContent.trim(),
        scrivania: row.cells[1].textContent.trim(),
        workstation: row.cells[2].textContent.trim(),
        monitor: row.cells[3].textContent.trim(),
        docking: row.cells[4].textContent.trim(),
        note: row.cells[5].textContent.trim()
      }));

      // ‚ö†Ô∏è In produzione NON inserire il token qui, usa un backend o GitHub Actions
      const token = inserimentodatiasset;
      const repo = SamHarker/asset;

      const response = await fetch(`https://api.github.com/repos/${repo}/dispatches`, {
        method: "POST",
        headers: {
          "Accept": "application/vnd.github+json",
          "Authorization": `Bearer ${token}`
        },
        body: JSON.stringify({
          event_type: "update-json",
          client_payload: { postazioni: rows }
        })
      });

      if (response.ok) {
        alert("‚úÖ Workflow avviato: i dati verranno salvati su GitHub!");
      } else {
        alert("‚ö†Ô∏è Errore nell'avvio del workflow");
        console.error(await response.json());
      }
    }

    // Funzione per aggiungere una nuova riga vuota
    function addRow() {
      const tbody = document.querySelector("#postazioni tbody");
      const row = tbody.insertRow();
      row.innerHTML = `
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td contenteditable="true"></td>
        <td><button class="remove-btn" onclick="removeRow(this)">‚ùå Rimuovi</button></td>
      `;
    }

    // Funzione per rimuovere una riga
    function removeRow(button) {
      button.closest("tr").remove();
    }
  </script>

</body>
</html>

